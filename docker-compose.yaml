version: '3'

services:
  python_app:
    container_name: python_app
    build: .
    # image: continuumio/miniconda
    stdin_open: true
    tty: true
    restart: always
    volumes:
      - .:/code
    ports:
      - ${FAST_API_PORT}:${FAST_API_DOCKER_PORT}
    command: python main.py
    depends_on:
      - db

  db:
    image: mariadb
    container_name: db
    restart: always
    environment:
      MARIADB_ROOT_PASSWORD: ${MARIADB_PASSWORD}
    ports:
      - ${MARIADB_PORT}:${MARIADB_DOCKER_PORT}
    volumes:
      - ./db-data:/docker-entrypoint-initdb.d


  phpmyadmin:
    image: phpmyadmin/phpmyadmin
    container_name: pma
    environment:
      PMA_HOST: db
      PMA_PORT: 3306
      PMA_ARBITRARY: 1
    restart: always
    ports:
      - ${PHP_MYADMIN_LOCAL_PORT}:${PHP_MYADMIN_DOCKER_PORT}

